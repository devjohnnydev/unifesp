{% extends "base.html" %}

{% block title %}Descrever Sintomas - TeleAcolhe{% endblock %}

{% block extra_head %}
<style>
    .form-step {
        display: none;
    }
    .form-step.active {
        display: block;
    }
</style>
{% endblock %}

{% block content %}
<section class="section">
    <div class="container">
        <div class="form-container">
            <div class="form-header">
                <h1>Descreva Seus Sintomas</h1>
                <p>Preencha as informações abaixo para receber uma análise inicial.</p>
            </div>
            
            <!-- Indicador de progresso -->
            <div class="progress-indicator" role="progressbar" aria-valuenow="1" aria-valuemin="1" aria-valuemax="4">
                <div class="progress-step active" data-step="1">
                    <div class="progress-circle">1</div>
                    <span>Dados Básicos</span>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="progress-circle">2</div>
                    <span>Sintomas</span>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="progress-circle">3</div>
                    <span>Detalhes</span>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="progress-circle">4</div>
                    <span>Confirmação</span>
                </div>
            </div>

            <form method="POST" action="{{ url_for('main.process_symptoms') }}" id="symptomsForm" novalidate>
                <!-- Etapa 1: Dados Básicos -->
                <div class="form-step active" data-step="1">
                    <h2>Informações Básicas</h2>
                    
                    <div class="form-group">
                        <label for="age">Idade <span class="required" aria-label="obrigatório">*</span></label>
                        <input 
                            type="number" 
                            id="age" 
                            name="age" 
                            min="0" 
                            max="120" 
                            required 
                            aria-required="true"
                            aria-describedby="age-help"
                        >
                        <small id="age-help" class="help-text">Digite sua idade em anos</small>
                        <span class="error-message" role="alert"></span>
                    </div>
                    
                    <div class="form-group">
                        <label for="sex">Sexo <span class="required" aria-label="obrigatório">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="sex" value="Masculino" required aria-required="true">
                                <span>Masculino</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="sex" value="Feminino" required aria-required="true">
                                <span>Feminino</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="sex" value="Outro" required aria-required="true">
                                <span>Outro</span>
                            </label>
                        </div>
                        <span class="error-message" role="alert"></span>
                    </div>
                </div>

                <!-- Etapa 2: Sintomas -->
                <div class="form-step" data-step="2">
                    <h2>Descreva Seus Sintomas</h2>
                    
                    <div class="form-group">
                        <label for="symptoms">O que você está sentindo? <span class="required" aria-label="obrigatório">*</span></label>
                        <textarea 
                            id="symptoms" 
                            name="symptoms" 
                            rows="6" 
                            required 
                            aria-required="true"
                            aria-describedby="symptoms-help"
                            maxlength="1000"
                        ></textarea>
                        <small id="symptoms-help" class="help-text">
                            Descreva seus sintomas da forma mais clara possível. 
                            Exemplo: "Dor de cabeça forte na região frontal, acompanhada de náusea"
                        </small>
                        <div class="char-counter">
                            <span id="charCount">0</span>/1000 caracteres
                        </div>
                        <span class="error-message" role="alert"></span>
                    </div>
                </div>

                <!-- Etapa 3: Detalhes -->
                <div class="form-step" data-step="3">
                    <h2>Detalhes dos Sintomas</h2>
                    
                    <div class="form-group">
                        <label for="duration">Há quanto tempo você tem esses sintomas? <span class="required" aria-label="obrigatório">*</span></label>
                        <select id="duration" name="duration" required aria-required="true">
                            <option value="">Selecione...</option>
                            <option value="Menos de 24 horas">Menos de 24 horas</option>
                            <option value="1-3 dias">1 a 3 dias</option>
                            <option value="4-7 dias">4 a 7 dias</option>
                            <option value="1-2 semanas">1 a 2 semanas</option>
                            <option value="Mais de 2 semanas">Mais de 2 semanas</option>
                            <option value="Mais de 1 mês">Mais de 1 mês</option>
                        </select>
                        <span class="error-message" role="alert"></span>
                    </div>
                    
                    <div class="form-group">
                        <label>Qual a intensidade dos sintomas? <span class="required" aria-label="obrigatório">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="intensity" value="Leve" required aria-required="true">
                                <span>Leve - Incomoda mas não atrapalha atividades</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="intensity" value="Moderada" required aria-required="true">
                                <span>Moderada - Atrapalha algumas atividades</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="intensity" value="Grave" required aria-required="true">
                                <span>Grave - Impede atividades normais</span>
                            </label>
                        </div>
                        <span class="error-message" role="alert"></span>
                    </div>
                </div>

                <!-- Etapa 4: Informações Adicionais -->
                <div class="form-step" data-step="4">
                    <h2>Informações Adicionais (Opcional)</h2>
                    
                    <div class="form-group">
                        <label for="additional_info">Outras informações relevantes</label>
                        <textarea 
                            id="additional_info" 
                            name="additional_info" 
                            rows="5"
                            aria-describedby="additional-help"
                            maxlength="500"
                        ></textarea>
                        <small id="additional-help" class="help-text">
                            Exemplo: condições médicas pré-existentes (diabetes, pressão alta), 
                            medicamentos que toma, alergias, gestação, etc.
                        </small>
                    </div>
                    
                    <div class="disclaimer-box" role="note">
                        <i data-feather="alert-triangle" aria-hidden="true"></i>
                        <p>
                            <strong>Lembre-se:</strong> Esta análise é apenas uma orientação inicial e 
                            <strong>NÃO substitui</strong> uma consulta médica presencial. 
                            Se seus sintomas forem graves, procure atendimento médico imediatamente.
                        </p>
                    </div>
                </div>

                <!-- Botões de navegação -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="prevBtn" style="display: none;">
                        <i data-feather="arrow-left" aria-hidden="true"></i>
                        Voltar
                    </button>
                    <button type="button" class="btn btn-primary" id="nextBtn">
                        Próximo
                        <i data-feather="arrow-right" aria-hidden="true"></i>
                    </button>
                    <button type="submit" class="btn btn-primary btn-submit" id="submitBtn" style="display: none;">
                        <i data-feather="send" aria-hidden="true"></i>
                        Analisar Sintomas
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/form.js') }}"></script>
{% endblock %}
